<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RestoGenie HQ - ê°€ë§¹ë³¸ì‚¬ í†µí•© ê´€ë¦¬</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/recharts@2.12.3/umd/Recharts.js"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body { font-family: 'Pretendard', sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .typing-cursor::after { content: 'â–‹'; animation: blink 1s step-start infinite; color: #3b82f6; }
        @keyframes blink { 50% { opacity: 0; } }
        .chat-bubble { max-width: 80%; padding: 12px 16px; border-radius: 16px; font-size: 14px; line-height: 1.5; }
        .chat-user { background-color: #2563eb; color: white; border-bottom-right-radius: 4px; margin-left: auto; }
        .chat-bot { background-color: #f1f5f9; color: #1e293b; border-bottom-left-radius: 4px; margin-right: auto; border: 1px solid #e2e8f0; }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: { 800: '#1e293b', 900: '#0f172a' },
                        brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8' }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

        // --- 1. Context Data (NotebookLM + OKR Report Integration) ---
        const OKR_REPORT_CONTEXT = `
        [ë¬¸ì„œ: ì»¨íŠ¸ë¡¤ì—  2025ë…„ 10ì›” OKR ì¢…í•© ë¦¬í¬íŠ¸ ìš”ì•½]
        1. í•µì‹¬ ìš”ì•½: 10ì›”ì€ 'ìŠ¬ë¨ë²„ê±° ëŒ€í•™ë¡œì 'ì˜ ì„±ê³µì ì¸ ì‹ ê·œ ì˜¤í”ˆìœ¼ë¡œ ì „ì‚¬ ë§¤ì¶œ ë³¼ë¥¨ì´ í™•ì¥ë¨. AI ì†”ë£¨ì…˜ 'ë ˆìŠ¤í† ì§€ë‹ˆ'ì˜ GTM ì „ëµì´ êµ¬ì²´í™”ë¨.
        2. ë§¤ì¶œ ì„±ê³¼: 
           - ì „ì‚¬ ì´ ë§¤ì¶œ: 2ì–µ 7,361ë§Œì› (ëª©í‘œ ëŒ€ë¹„ 108% ë‹¬ì„±).
           - ëŒ€í•™ë¡œì : ì‹ ê·œ ì˜¤í”ˆ ì„±ê³µ, ë°ì´í„° ê¸°ë°˜ ìƒê¶Œ ë¶„ì„ê³¼ ì˜¤í”„ë¼ì¸ í”„ë¡œëª¨ì…˜ ì ì¤‘.
           - ê¸°ì¡´ ì§ì˜ì : ìˆ˜ìµì„± ê°œì„ ê³¼ ì‹ ê·œ ê³ ê° ìœ ì… ì¦ëŒ€ê°€ ê³¼ì œë¡œ ë‚¨ìŒ (ì„±ì¥ ì •ì²´).
        3. ê¸°ìˆ /íŒŒíŠ¸ë„ˆì‹­:
           - ë©”ì´ì•„ì´(Mei AI) í˜‘ë ¥ ê°•í™”: íœ´ëŒ€ìš© ìœ ë™ì¸êµ¬ ì¸¡ì • ì¥ë¹„ ê³µë™ ê°œë°œ ë…¼ì˜ ì¤‘.
           - ë‚´ë¶€ ë©ìŠ¤(Labs) êµ¬ì¶•: ì‹ ê·œ ê¸°ëŠ¥ í”„ë¡œí† íƒ€ì´í•‘ í™˜ê²½ ì¡°ì„±.
        4. ì „ëµ ì œì–¸:
           - 'ì„±ê³µ ê³µì‹(ëŒ€í•™ë¡œì  ëª¨ë¸)'ì˜ ì „ì‚¬ í™•ì‚°.
           - B2B ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ ê°œë°œ ê°€ì†í™”.
        `;

        const API_KEY = ""; // â˜… ì—¬ê¸°ì— ë°œê¸‰ë°›ì€ Gemini API Keyë¥¼ ì…ë ¥í•˜ë©´ ì‹¤ì œ ì‘ë™í•©ë‹ˆë‹¤. (ë°ëª¨ìš© ê³µë€)

        // --- 2. Components ---

        // Chatbot
        const AIChatbot = () => {
            const [isOpen, setIsOpen] = useState(false);
            const [messages, setMessages] = useState([{ role: 'model', text: 'ì•ˆë…•í•˜ì„¸ìš”! 10ì›” OKR ë¦¬í¬íŠ¸ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€í•´ ë“œë¦½ë‹ˆë‹¤. ë¬´ì—‡ì´ë“  ë¬¼ì–´ë³´ì„¸ìš”.' }]);
            const [input, setInput] = useState('');
            const [loading, setLoading] = useState(false);
            const scrollRef = useRef(null);

            useEffect(() => { if(scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight; }, [messages]);

            const sendMessage = async () => {
                if (!input.trim()) return;
                const userMsg = input;
                setMessages(prev => [...prev, { role: 'user', text: userMsg }]);
                setInput('');
                setLoading(true);

                try {
                    // Gemini API Call Structure
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ 
                                role: "user", 
                                parts: [{ text: `Context:\n${OKR_REPORT_CONTEXT}\n\nQuestion: ${userMsg}\n\nAnswer as a HQ Strategy Assistant.` }] 
                            }]
                        })
                    });
                    
                    if (!response.ok) throw new Error('API Error');
                    const data = await response.json();
                    const botMsg = data.candidates[0].content.parts[0].text;
                    setMessages(prev => [...prev, { role: 'model', text: botMsg }]);
                } catch (e) {
                    // Fallback for Demo without API Key
                    setTimeout(() => {
                        setMessages(prev => [...prev, { role: 'model', text: `(API í‚¤ ë¯¸ì…ë ¥ ì‹œ ë°ëª¨ ì‘ë‹µ)\n10ì›” OKR ë¦¬í¬íŠ¸ì— ë”°ë¥´ë©´, ëŒ€í•™ë¡œì  ì˜¤í”ˆì´ ì „ì‚¬ ë§¤ì¶œ ì„±ì¥ì„ ê²¬ì¸í–ˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ ê¸°ì¡´ ì í¬ì˜ ìˆ˜ìµì„± ê°œì„ ì´ ì‹œê¸‰í•œ ê³¼ì œì…ë‹ˆë‹¤.` }]);
                        setLoading(false);
                    }, 1000);
                } finally {
                    setLoading(false);
                }
            };

            if(!isOpen) return (
                <button onClick={()=>setIsOpen(true)} className="fixed bottom-6 right-6 bg-navy-900 text-white p-4 rounded-full shadow-xl hover:bg-navy-800 transition z-50">
                    <i data-lucide="message-square" className="w-6 h-6"></i>
                </button>
            );

            return (
                <div className="fixed bottom-6 right-6 z-50 w-96 h-[500px] bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col animate-fade-in overflow-hidden">
                    <div className="bg-navy-900 text-white p-4 flex justify-between items-center">
                        <span className="font-bold flex items-center gap-2"><i data-lucide="bot" className="w-5 h-5"></i> HQ Knowledge Bot</span>
                        <button onClick={()=>setIsOpen(false)}><i data-lucide="x" className="w-5 h-5"></i></button>
                    </div>
                    <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50" ref={scrollRef}>
                        {messages.map((m, i) => (
                            <div key={i} className={`flex ${m.role==='user'?'justify-end':'justify-start'}`}>
                                <div className={`chat-bubble ${m.role==='user'?'chat-user':'chat-bot'}`}>{m.text}</div>
                            </div>
                        ))}
                        {loading && <div className="text-xs text-slate-400 ml-2 animate-pulse">ë¶„ì„ ì¤‘...</div>}
                    </div>
                    <div className="p-3 border-t bg-white flex gap-2">
                        <input className="flex-1 border rounded-lg px-3 py-2 text-sm outline-none focus:border-brand-500" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." value={input} onChange={e=>setInput(e.target.value)} onKeyPress={e=>e.key==='Enter'&&sendMessage()} />
                        <button onClick={sendMessage} disabled={loading} className="bg-brand-600 text-white p-2 rounded-lg"><i data-lucide="send" className="w-4 h-4"></i></button>
                    </div>
                </div>
            );
        };

        // Dashboard View
        const DashboardView = ({ storeId }) => {
            // Mock Data Logic based on OKR Report
            const isAll = storeId === 'all';
            const data = {
                sales: isAll ? 273610500 : (storeId === 'daehangno' ? 87500000 : 98853000),
                growth: isAll ? 12.3 : (storeId === 'daehangno' ? 'New' : 8.1), // ëŒ€í•™ë¡œì  ì‹ ê·œì˜¤í”ˆ ë°˜ì˜
                chartData: [
                    { name: '1ì£¼', val: isAll ? 6200 : 2100 },
                    { name: '2ì£¼', val: isAll ? 6800 : 2300 },
                    { name: '3ì£¼', val: isAll ? 7100 : 2450 },
                    { name: '4ì£¼', val: isAll ? 7260 : 2500 },
                ]
            };

            return (
                <div className="space-y-6 animate-fade-in">
                    <div className="grid grid-cols-4 gap-5">
                        <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <p className="text-slate-500 text-sm">ì´ ë§¤ì¶œ (10ì›”)</p>
                            <h3 className="text-2xl font-bold text-navy-900">â‚©{data.sales.toLocaleString()}</h3>
                            <p className="text-sm text-red-500 mt-1 flex items-center gap-1"><i data-lucide="trending-up" className="w-4 h-4"></i> {data.growth === 'New' ? 'ì‹ ê·œ ì˜¤í”ˆ' : `+${data.growth}%`}</p>
                        </div>
                         <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <p className="text-slate-500 text-sm">ëª©í‘œ ë‹¬ì„±ë¥ </p>
                            <h3 className="text-2xl font-bold text-blue-600">108%</h3>
                            <p className="text-sm text-slate-400 mt-1">Target: 2.5ì–µ</p>
                        </div>
                         <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <p className="text-slate-500 text-sm">ì›ê°€ìœ¨</p>
                            <h3 className="text-2xl font-bold text-navy-900">38.5%</h3>
                            <p className="text-sm text-red-500 mt-1">âš ï¸ ì „ì›”ë¹„ +1.5%p</p>
                        </div>
                         <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <p className="text-slate-500 text-sm">ì´ ì£¼ë¬¸ìˆ˜</p>
                            <h3 className="text-2xl font-bold text-navy-900">14,520ê±´</h3>
                        </div>
                    </div>

                    <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-80">
                        <h3 className="font-bold text-lg text-navy-900 mb-4">ë§¤ì¶œ ì¶”ì´ ({storeId === 'all' ? 'ì „ì‚¬' : storeId})</h3>
                        <ResponsiveContainer width="100%" height="100%">
                            <LineChart data={data.chartData}>
                                <CartesianGrid strokeDasharray="3 3" vertical={false} />
                                <XAxis dataKey="name" />
                                <YAxis tickFormatter={(v)=>`${v}ë§Œ`} />
                                <Tooltip />
                                <Line type="monotone" dataKey="val" stroke="#2563eb" strokeWidth={3} />
                            </LineChart>
                        </ResponsiveContainer>
                    </div>
                </div>
            );
        };

        // AI Report View
        const AIReportView = ({ credits, setCredits }) => {
            const [result, setResult] = useState('');
            const [loading, setLoading] = useState(false);

            const generate = async () => {
                if(credits < 5) return alert('ì½”ì¸ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.');
                setCredits(c => c - 5);
                setLoading(true);
                setResult('');

                try {
                    const prompt = `${OKR_REPORT_CONTEXT}\n\nìœ„ OKR ë¦¬í¬íŠ¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ 11ì›” ê²½ì˜ ì „ëµ íšŒì˜ë¥¼ ìœ„í•œ 'ì£¼ê°„ íšŒì˜ë¡ ì´ˆì•ˆ'ì„ ì‘ì„±í•´ì¤˜. ê²°ì •ì‚¬í•­, ì•¡ì…˜ì•„ì´í…œ(ë‹´ë‹¹ì í¬í•¨), ì£¼ìš” ë…¼ì˜ì‚¬í•­ì„ ë§ˆí¬ë‹¤ìš´ìœ¼ë¡œ ì •ë¦¬í•´.`;
                    
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });
                    
                    if(!response.ok) throw new Error('API Error');
                    const data = await response.json();
                    const text = data.candidates[0].content.parts[0].text;
                    
                    // Typing Effect
                    let i = 0;
                    const interval = setInterval(() => {
                        setResult(prev => prev + text.charAt(i));
                        i++;
                        if(i >= text.length) { clearInterval(interval); setLoading(false); }
                    }, 10);

                } catch (e) {
                    // Fallback
                    setTimeout(() => {
                        const mock = `## ğŸ“… 11ì›” ê²½ì˜ ì „ëµ íšŒì˜ë¡ (Generated by Gemini)\n\n### 1. ğŸ¯ ê²°ì •ì‚¬í•­\n* **ëŒ€í•™ë¡œì  ì„±ê³µ ëª¨ë¸ í™•ì‚°**: ëŒ€í•™ë¡œì ì˜ ì˜¤í”„ë¼ì¸ í”„ë¡œëª¨ì…˜ ë° ì§€ì—­ ì œíœ´ ì „ëµì„ 'í‘œì¤€ í”Œë ˆì´ë¶'ìœ¼ë¡œ ì œì •í•˜ì—¬ íƒ€ ì§€ì ì— ì „íŒŒ.\n* **ìŠ¤ë§ˆíŠ¸íŒœ ë„ì… í™•ì •**: ì–‘ìƒì¶” ì›ê°€ìœ¨ 1.5%p ìƒìŠ¹ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ íŒœì—ì´íŠ¸ì™€ì˜ ê³„ì•½ ì²´ê²° ìŠ¹ì¸.\n\n### 2. âœ… ì•¡ì…˜ ì•„ì´í…œ\n| ë‹´ë‹¹ì | ë‚´ìš© | ê¸°í•œ |\n|---|---|---|\n| **ìš´ì˜íŒ€** | ëŒ€í•™ë¡œì  ì ì‹¬ í”¼í¬íƒ€ì„ ë³‘ëª© í˜„ìƒ í•´ê²°ì„ ìœ„í•œ KDS ë„ì… ê²€í†  | 11/20 |\n| **ë§ˆì¼€íŒ…íŒ€** | ê¸°ì¡´ ì§ì˜ì (ê°•ë‚¨ ë“±) ìˆ˜ìµì„± ê°œì„ ì„ ìœ„í•œ ì‹ ê·œ ê³ ê° ìœ ì… ìº í˜ì¸ ê¸°íš | 11/25 |\n| **ê°œë°œíŒ€** | B2B ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ ë² íƒ€ ë²„ì „ ë‚´ë¶€ í…ŒìŠ¤íŠ¸ ì°©ìˆ˜ | 11/30 |\n\n### 3. ğŸ’¡ ì£¼ìš” ë…¼ì˜\n* **ì„±ì¥ ì •ì²´ ëŒ€ì‘**: 10ì›” ë§¤ì¶œ ì„±ì¥ì€ ì‹ ê·œ ì í¬(ëŒ€í•™ë¡œ) íš¨ê³¼ê°€ ì»¸ìœ¼ë©°, ê¸°ì¡´ ì í¬ëŠ” ì„±ì¥ì´ ì •ì²´ë¨. ì´ë¥¼ íƒ€ê°œí•˜ê¸° ìœ„í•´ 'RestoGenie' ì†”ë£¨ì…˜ì˜ ë°ì´í„° ë¶„ì„ ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ ì§€ì ë³„ ë§ì¶¤í˜• ì»¨ì„¤íŒ…ì„ ê°•í™”í•˜ê¸°ë¡œ í•¨.`;
                        setResult(mock);
                        setLoading(false);
                    }, 1500);
                }
            };

            return (
                <div className="flex h-full gap-6 animate-fade-in">
                    <div className="w-1/3 bg-white p-6 rounded-xl border shadow-sm flex flex-col">
                        <h2 className="font-bold text-lg mb-4 flex items-center gap-2"><i data-lucide="sparkles" className="text-brand-600"></i> ë¦¬í¬íŠ¸ ìƒì„±</h2>
                        <div className="bg-blue-50 p-4 rounded-lg text-sm text-blue-800 mb-6">
                            <strong>ğŸ“š ì°¸ì¡° ë°ì´í„°:</strong><br/>
                            - 2025ë…„ 10ì›” OKR ì¢…í•© ë¦¬í¬íŠ¸<br/>
                            - ìŠ¬ë¨ë²„ê±° ì „ì‚¬ ë§¤ì¶œ DB<br/>
                            - ë©”ì´ì•„ì´ ìœ ë™ì¸êµ¬ ë°ì´í„°
                        </div>
                        <button onClick={generate} disabled={loading} className="w-full bg-brand-600 text-white py-3 rounded-lg font-bold hover:bg-brand-700 transition flex justify-center items-center gap-2 disabled:opacity-50">
                            {loading ? <i data-lucide="loader-2" className="animate-spin"></i> : <i data-lucide="zap"></i>} 
                            {loading ? "Gemini ë¶„ì„ ì¤‘..." : "ì£¼ê°„ íšŒì˜ë¡ ìƒì„± (5 Coin)"}
                        </button>
                    </div>
                    <div className="flex-1 bg-white p-8 rounded-xl border shadow-sm overflow-y-auto canvas-editor">
                        {result ? <div className="prose prose-sm max-w-none whitespace-pre-line typing-cursor text-slate-700">{result}</div> : 
                        <div className="h-full flex flex-col items-center justify-center text-slate-400">
                            <i data-lucide="file-text" className="w-12 h-12 mb-2 opacity-50"></i>
                            <p>ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ë©´ ì´ê³³ì— ì‘ì„±ë©ë‹ˆë‹¤.</p>
                        </div>}
                    </div>
                </div>
            );
        };

        // App
        const App = () => {
            const [menu, setMenu] = useState('dashboard');
            const [store, setStore] = useState('all');
            const [credits, setCredits] = useState(100);

            useEffect(() => { if(window.lucide) window.lucide.createIcons(); });

            return (
                <div className="flex min-h-screen">
                    <aside className="w-64 bg-navy-900 text-white fixed h-full flex flex-col z-10">
                        <div className="p-6 border-b border-navy-800 text-xl font-bold flex items-center gap-2">
                            <i data-lucide="layout-dashboard" className="text-brand-500"></i> RestoGenie
                        </div>
                        <nav className="flex-1 p-4 space-y-1">
                            <button onClick={()=>setMenu('dashboard')} className={`w-full flex items-center gap-3 px-3 py-3 rounded-lg text-sm ${menu==='dashboard'?'bg-brand-600 font-bold':'hover:bg-navy-800 text-slate-300'}`}><i data-lucide="bar-chart-2"></i> ëŒ€ì‹œë³´ë“œ</button>
                            <button onClick={()=>setMenu('report')} className={`w-full flex items-center gap-3 px-3 py-3 rounded-lg text-sm ${menu==='report'?'bg-brand-600 font-bold':'hover:bg-navy-800 text-slate-300'}`}><i data-lucide="file-text"></i> AI ë¦¬í¬íŠ¸</button>
                        </nav>
                    </aside>
                    <main className="ml-64 flex-1 p-8 relative">
                        <div className="flex justify-between items-center mb-8">
                            <h1 className="text-2xl font-bold text-navy-900">{menu==='dashboard'?'ìš´ì˜ í˜„í™©':'AI ë¦¬í¬íŠ¸ ì„¼í„°'}</h1>
                            <div className="flex gap-4 items-center">
                                <select className="border p-2 rounded-lg bg-white font-bold" value={store} onChange={e=>setStore(e.target.value)}>
                                    <option value="all">ì „ì‚¬ (All)</option>
                                    <option value="gangnam">ê°•ë‚¨ì </option>
                                    <option value="daehangno">ëŒ€í•™ë¡œì </option>
                                </select>
                                <div className="bg-white border px-3 py-1.5 rounded-full shadow-sm flex items-center gap-2">
                                    <div className="w-5 h-5 bg-yellow-400 rounded-full flex items-center justify-center text-xs text-white font-bold">P</div>
                                    <span className="font-bold text-sm">{credits}</span>
                                </div>
                            </div>
                        </div>
                        {menu === 'dashboard' && <DashboardView storeId={store} />}
                        {menu === 'report' && <AIReportView credits={credits} setCredits={setCredits} />}
                        <AIChatbot />
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
