<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RestoGenie HQ - ê°€ë§¹ë³¸ì‚¬ í†µí•© ê´€ë¦¬</title>
    
    <!-- React 17 (CDN ì•ˆì •ì„± í™•ë³´) -->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Recharts (UMD) -->
    <script src="https://unpkg.com/recharts@2.1.9/umd/Recharts.js"></script>

    <!-- Font -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    
    <style>
        body { font-family: 'Pretendard', sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .typing-cursor::after { content: 'â–‹'; animation: blink 1s step-start infinite; color: #3b82f6; }
        @keyframes blink { 50% { opacity: 0; } }
        .chat-bubble { max-width: 80%; padding: 12px 16px; border-radius: 16px; font-size: 14px; line-height: 1.5; }
        .chat-user { background-color: #2563eb; color: white; border-bottom-right-radius: 4px; margin-left: auto; }
        .chat-bot { background-color: #f1f5f9; color: #1e293b; border-bottom-left-radius: 4px; margin-right: auto; border: 1px solid #e2e8f0; }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: { 800: '#1e293b', 900: '#0f172a' },
                        brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8' }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        // Recharts ê°ì²´ì—ì„œ ì»´í¬ë„ŒíŠ¸ ì¶”ì¶œ (ì•ˆì „í•œ ë°©ì‹)
        const { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, PieChart, Pie, Cell } = Recharts;

        // --- 1. Configuration & Context (OKR Report Injection) ---
        const API_KEY = "AIzaSyCILSrQKjRiupRcyNd1pFJUksNMkGVY8AQ"; 

        const OKR_CONTEXT = `
        [ì»¨íŠ¸ë¡¤ì—  2025ë…„ 10ì›” ì „ì‚¬ OKR ì¢…í•© ë¦¬í¬íŠ¸ í•µì‹¬ ìš”ì•½]
        
        1. **ì „ì‚¬ í•µì‹¬ ì„±ê³¼**:
           - 10ì›” ì´ ë§¤ì¶œ: **2ì–µ 7,361ë§Œì›** (ëª©í‘œ ëŒ€ë¹„ 108% ë‹¬ì„±).
           - ì„±ì¥ ë™ë ¥: ìŠ¬ë¨ë²„ê±° ëŒ€í•™ë¡œì (ì‹ ê·œ)ì˜ ì„±ê³µì ì¸ ì˜¤í”ˆì´ ë§¤ì¶œ ë³¼ë¥¨ í™•ì¥ì„ ê²¬ì¸í•¨.
        
        2. **ë§¤ì¥ë³„ í˜„í™© ë° ì´ìŠˆ**:
           - **ëŒ€í•™ë¡œì  (ì„±ê³µ/ê³¼ì œ)**: ë°ì´í„° ê¸°ë°˜ ìƒê¶Œ ë¶„ì„ê³¼ ì˜¤í”„ë¼ì¸ í”„ë¡œëª¨ì…˜ì´ ì ì¤‘í•˜ì—¬ ì¡°ê¸° ì•ˆì°©í•¨. ê·¸ëŸ¬ë‚˜ ì ì‹¬ í”¼í¬íƒ€ì„(12~13ì‹œ) ì£¼ë¬¸ í­ì£¼ë¡œ ë³‘ëª© í˜„ìƒì´ ë°œìƒí•˜ì—¬ ê³ ê° ëŒ€ê¸° ì‹œê°„ì´ ê¸¸ì–´ì§. KDS(ì£¼ë°© ë””ìŠ¤í”Œë ˆì´) ë„ì… ì‹œê¸‰.
           - **ê°•ë‚¨ì  (ì •ì²´)**: ë§¤ì¶œ 9,885ë§Œì›. ë°°ë‹¬ ë¹„ì¤‘ì´ ë†’ìœ¼ë‚˜ ê¸°ì¡´ì  ì„±ì¥ì„¸ê°€ ë‘”í™”ë¨. ìˆ˜ìµì„± ê°œì„ ì„ ìœ„í•œ ë°°ë‹¬ ê´‘ê³  íš¨ìœ¨í™” í•„ìš”.
        
        3. **ì£¼ìš” ì´ìŠˆ ë° ì „ëµ**:
           - **ì›ê°€ìœ¨ ê²½ê³ **: ì–‘ìƒì¶” ê°€ê²© í­ë“±ìœ¼ë¡œ ì „ì‚¬ ì›ê°€ìœ¨ì´ **38.5% (+1.5%p)**ê¹Œì§€ ìƒìŠ¹í•¨. ì´ì— ëŒ€í•œ ëŒ€ì±…ìœ¼ë¡œ 'ìŠ¤ë§ˆíŠ¸íŒœ ê³„ì•½ ì¬ë°°' ë„ì…ì„ ê²°ì •í•¨.
           - **íŒŒíŠ¸ë„ˆì‹­**: 'ë©”ì´ì•„ì´(Mei AI)'ì™€ í˜‘ë ¥í•˜ì—¬ íœ´ëŒ€ìš© ìœ ë™ì¸êµ¬ ì¸¡ì • ì¥ë¹„ ê³µë™ ê°œë°œì„ ë…¼ì˜ ì¤‘ì„.
        
        4. **í–¥í›„ ê³„íš**: ëŒ€í•™ë¡œì ì˜ ì„±ê³µ ëª¨ë¸(ì˜¤í”„ë¼ì¸ í”„ë¡œëª¨ì…˜ ë“±)ì„ ì „ì‚¬ë¡œ í™•ì‚°í•˜ê³ , B2B ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ ê°œë°œì„ ê°€ì†í™”í•¨.
        `;

        // --- 2. Mock Data Generator ---
        const STORES = [
            { id: 'all', name: 'ì „ì‚¬ (All Stores)' },
            { id: 'gangnam', name: 'ê°•ë‚¨ì ' },
            { id: 'daehangno', name: 'ëŒ€í•™ë¡œì ' },
            { id: 'sindang', name: 'ì‹ ë‹¹ì ' },
            { id: 'yeokgok', name: 'ì—­ê³¡ì ' }
        ];

        const getStoreData = (storeId) => {
            const isAll = storeId === 'all';
            const factor = isAll ? 1 : (storeId === 'gangnam' ? 0.36 : storeId === 'daehangno' ? 0.32 : 0.16);
            
            return {
                kpi: {
                    sales: Math.floor(273610500 * factor),
                    orders: Math.floor(14520 * factor),
                    ticket: isAll ? 18840 : 19200,
                    costRate: isAll ? 38.5 : (storeId === 'daehangno' ? 41.2 : 36.5),
                    adSpend: Math.floor(15000000 * factor),
                    hallShare: isAll ? 65 : (storeId === 'gangnam' ? 45 : 75),
                    growth: isAll ? 12.3 : (storeId === 'daehangno' ? 0 : 8.1) 
                },
                trend: [
                    { name: '1ì£¼', sales: Math.floor(62000000 * factor), ad: Math.floor(3500000 * factor) },
                    { name: '2ì£¼', sales: Math.floor(68000000 * factor), ad: Math.floor(3800000 * factor) },
                    { name: '3ì£¼', sales: Math.floor(71000000 * factor), ad: Math.floor(4000000 * factor) },
                    { name: '4ì£¼', sales: Math.floor(72610500 * factor), ad: Math.floor(3700000 * factor) },
                ]
            };
        };

        // --- Error Boundary ---
        class ErrorBoundary extends React.Component {
            constructor(props) { super(props); this.state = { hasError: false, error: null }; }
            static getDerivedStateFromError(error) { return { hasError: true, error }; }
            render() {
                if (this.state.hasError) return <div className="p-4 text-red-600 bg-red-50 rounded">UI ë Œë”ë§ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {this.state.error.toString()}</div>;
                return this.props.children;
            }
        }

        // --- 3. Components ---

        // [AI Chatbot]
        const AIChatbot = () => {
            const [isOpen, setIsOpen] = useState(false);
            const [messages, setMessages] = useState([{ role: 'model', text: 'ì•ˆë…•í•˜ì„¸ìš”! 10ì›” OKR ë¦¬í¬íŠ¸ë¥¼ í•™ìŠµí•œ AI ë¹„ì„œì…ë‹ˆë‹¤. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?' }]);
            const [input, setInput] = useState('');
            const [loading, setLoading] = useState(false);
            const scrollRef = useRef(null);

            useEffect(() => { if(scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight; }, [messages]);
            useEffect(() => { if(window.lucide) window.lucide.createIcons(); }, [isOpen]);

            const sendMessage = async () => {
                if (!input.trim()) return;
                const userMsg = input;
                setMessages(prev => [...prev, { role: 'user', text: userMsg }]);
                setInput('');
                setLoading(true);

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ 
                                role: "user", 
                                parts: [{ text: `Context:\n${OKR_CONTEXT}\n\nQuestion: ${userMsg}\n\nAnswer as a HQ Strategy Assistant (Korean).` }] 
                            }]
                        })
                    });
                    const data = await response.json();
                    const botMsg = data.candidates?.[0]?.content?.parts?.[0]?.text || "ì£„ì†¡í•©ë‹ˆë‹¤. ë‹µë³€ì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                    setMessages(prev => [...prev, { role: 'model', text: botMsg }]);
                } catch (e) {
                    setMessages(prev => [...prev, { role: 'model', text: `ì—ëŸ¬ ë°œìƒ: ${e.message}` }]);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <React.Fragment>
                    {!isOpen && (
                        <button onClick={()=>setIsOpen(true)} className="fixed bottom-6 right-6 bg-navy-900 text-white p-4 rounded-full shadow-xl hover:bg-navy-800 transition z-50 flex items-center justify-center">
                            <i data-lucide="message-square" className="w-6 h-6"></i>
                        </button>
                    )}
                    {isOpen && (
                        <div className="fixed bottom-6 right-6 z-50 w-96 h-[500px] bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col animate-fade-in overflow-hidden">
                            <div className="bg-navy-900 text-white p-4 flex justify-between items-center">
                                <span className="font-bold flex items-center gap-2"><i data-lucide="bot" className="w-5 h-5"></i> HQ AI ë¹„ì„œ</span>
                                <button onClick={()=>setIsOpen(false)}><i data-lucide="x" className="w-5 h-5"></i></button>
                            </div>
                            <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50" ref={scrollRef}>
                                {messages.map((m, i) => (
                                    <div key={i} className={`flex ${m.role==='user'?'justify-end':'justify-start'}`}>
                                        <div className={`chat-bubble ${m.role==='user'?'chat-user':'chat-bot'}`}>{m.text}</div>
                                    </div>
                                ))}
                                {loading && <div className="text-xs text-slate-400 ml-2 animate-pulse">AIê°€ ë¶„ì„ ì¤‘...</div>}
                            </div>
                            <div className="p-3 border-t bg-white flex gap-2">
                                <input className="flex-1 border rounded-lg px-3 py-2 text-sm outline-none focus:border-brand-500" placeholder="ì§ˆë¬¸ ì…ë ¥..." value={input} onChange={e=>setInput(e.target.value)} onKeyPress={e=>e.key==='Enter'&&sendMessage()} />
                                <button onClick={sendMessage} disabled={loading} className="bg-brand-600 text-white p-2 rounded-lg"><i data-lucide="send" className="w-4 h-4"></i></button>
                            </div>
                        </div>
                    )}
                </React.Fragment>
            );
        };

        // [Dashboard View]
        const DashboardView = ({ storeId }) => {
            const data = useMemo(() => getStoreData(storeId), [storeId]);

            return (
                <div className="space-y-6 animate-fade-in">
                    {/* KPI Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5">
                        <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <p className="text-slate-500 text-sm font-medium">ì´ ë§¤ì¶œ (10ì›”)</p>
                            <h3 className="text-2xl font-bold text-navy-900 mt-1">â‚©{data.kpi.sales.toLocaleString()}</h3>
                            <p className={`text-sm mt-2 flex items-center gap-1 ${data.kpi.growth>=0 ? 'text-red-500' : 'text-blue-500'}`}>
                                {data.kpi.growth >= 0 ? 'â–²' : 'â–¼'} {Math.abs(data.kpi.growth)}% (MoM)
                            </p>
                        </div>
                        <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <p className="text-slate-500 text-sm font-medium">ì´ ì£¼ë¬¸ìˆ˜</p>
                            <h3 className="text-2xl font-bold text-navy-900 mt-1">{data.kpi.orders.toLocaleString()}ê±´</h3>
                            <p className="text-sm mt-2 text-slate-400">í™€ {data.kpi.hallShare}% / ë°°ë‹¬ {100-data.kpi.hallShare}%</p>
                        </div>
                        <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <p className="text-slate-500 text-sm font-medium">ì›ê°€ìœ¨</p>
                            <h3 className="text-2xl font-bold text-navy-900 mt-1">{data.kpi.costRate}%</h3>
                            <p className="text-sm mt-2 text-red-500 font-medium">âš ï¸ ì „ì›”ë¹„ +1.5%p (ì–‘ìƒì¶” ì´ìŠˆ)</p>
                        </div>
                        <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <p className="text-slate-500 text-sm font-medium">ê´‘ê³ ë¹„ ì§‘í–‰</p>
                            <h3 className="text-2xl font-bold text-navy-900 mt-1">â‚©{data.kpi.adSpend.toLocaleString()}</h3>
                            <p className="text-sm mt-2 text-slate-400">ë§¤ì¶œ ëŒ€ë¹„ {(data.kpi.adSpend/data.kpi.sales*100).toFixed(1)}%</p>
                        </div>
                    </div>

                    {/* Charts */}
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96">
                            <h3 className="font-bold text-lg text-navy-900 mb-4">ë§¤ì¶œ ë° ê´‘ê³ ë¹„ ì¶”ì´ ({STORES.find(s=>s.id===storeId).name})</h3>
                            <ResponsiveContainer width="100%" height="100%">
                                <LineChart data={data.trend}>
                                    <CartesianGrid strokeDasharray="3 3" vertical={false} />
                                    <XAxis dataKey="name" />
                                    <YAxis yAxisId="left" tickFormatter={(v)=>`${v/10000}ë§Œ`} />
                                    <YAxis yAxisId="right" orientation="right" tickFormatter={(v)=>`${v/10000}ë§Œ`} />
                                    <Tooltip formatter={(v)=>`â‚©${v.toLocaleString()}`} />
                                    <Legend />
                                    <Line yAxisId="left" type="monotone" dataKey="sales" name="ë§¤ì¶œ" stroke="#2563eb" strokeWidth={3} dot={{r:4}} />
                                    <Line yAxisId="right" type="monotone" dataKey="ad" name="ê´‘ê³ ë¹„" stroke="#f59e0b" strokeWidth={2} />
                                </LineChart>
                            </ResponsiveContainer>
                        </div>
                        <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                             <h3 className="font-bold text-lg text-navy-900 mb-4">AI ì¸ì‚¬ì´íŠ¸</h3>
                             <div className="space-y-3 flex-1 overflow-y-auto">
                                <div className="p-3 bg-red-50 text-red-800 rounded-lg text-sm border border-red-100">
                                    <strong>âš ï¸ ì›ê°€ ì£¼ì˜</strong><br/>
                                    ì–‘ìƒì¶” ê°€ê²© í­ë“±ìœ¼ë¡œ ì „ì‚¬ ì›ê°€ìœ¨ì´ 38.5%ê¹Œì§€ ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤. ìŠ¤ë§ˆíŠ¸íŒœ ë„ì…ì´ ì‹œê¸‰í•©ë‹ˆë‹¤.
                                </div>
                                <div className="p-3 bg-blue-50 text-blue-800 rounded-lg text-sm border border-blue-100">
                                    <strong>ğŸš€ ëŒ€í•™ë¡œì  ì„±ê³¼</strong><br/>
                                    ì˜¤í”ˆ ì´ˆê¸° ë§ˆì¼€íŒ… ì„±ê³µìœ¼ë¡œ ëª©í‘œ ë§¤ì¶œ 108% ì´ˆê³¼ ë‹¬ì„± ì¤‘ì…ë‹ˆë‹¤. ë‹¤ë§Œ ì ì‹¬ í”¼í¬íƒ€ì„ ëŒ€ê¸°ê°€ ê¸¸ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤.
                                </div>
                                <div className="p-3 bg-slate-50 text-slate-700 rounded-lg text-sm border border-slate-200">
                                    <strong>ğŸ’¡ íŒŒíŠ¸ë„ˆì‹­</strong><br/>
                                    ë©”ì´ì•„ì´(Mei AI)ì™€ ìœ ë™ì¸êµ¬ ë¶„ì„ ì†”ë£¨ì…˜ ê°œë°œ í˜‘ì˜ê°€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.
                                </div>
                             </div>
                        </div>
                    </div>
                </div>
            );
        };

        // [AI Report View]
        const AIReportView = ({ credits, setCredits }) => {
            const [mode, setMode] = useState('weekly');
            const [result, setResult] = useState('');
            const [loading, setLoading] = useState(false);

            const generate = async () => {
                const cost = mode === 'weekly' ? 5 : 1;
                if(credits < cost) return alert('ì½”ì¸ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.');
                
                setCredits(c => c - cost);
                setLoading(true);
                setResult('');

                const prompt = mode === 'weekly' 
                    ? `${OKR_CONTEXT}\n\nìœ„ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ [11ì›” 2ì£¼ì°¨ ì£¼ê°„ íšŒì˜ë¡]ì„ ì‘ì„±í•´ì¤˜. ê²°ì •ì‚¬í•­(ì›ê°€, íŒŒíŠ¸ë„ˆì‹­ ë“±), ì•¡ì…˜ì•„ì´í…œ(ë‹´ë‹¹ì í¬í•¨), ì´ìŠˆì‚¬í•­ì„ ë§ˆí¬ë‹¤ìš´ìœ¼ë¡œ ì •ë¦¬í•´.`
                    : `${OKR_CONTEXT}\n\nìœ„ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ [ëŒ€í•™ë¡œì  ë§¤ì¥ ì ê²€ ë¦¬í¬íŠ¸]ë¥¼ ì‘ì„±í•´ì¤˜. ë§¤ì¶œë¶„ì„(ì„±ê³µìš”ì¸), ìš´ì˜ì´ìŠˆ(í”¼í¬íƒ€ì„ ë³‘ëª©), ê°œì„ ì œì•ˆ(KDS ë„ì… ë“±)ì„ í¬í•¨í•´.`;

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });
                    const data = await response.json();
                    const text = data.candidates[0].content.parts[0].text;
                    
                    let i = 0;
                    const interval = setInterval(() => {
                        setResult(prev => prev + text.charAt(i));
                        i++;
                        if(i >= text.length) { clearInterval(interval); setLoading(false); }
                    }, 10);
                } catch (e) {
                    setResult(`ìƒì„± ì‹¤íŒ¨: ${e.message}`);
                    setLoading(false);
                }
            };

            return (
                <div className="flex h-full gap-6 animate-fade-in">
                    <div className="w-1/3 bg-white p-6 rounded-xl border shadow-sm flex flex-col">
                        <h2 className="font-bold text-lg mb-6 flex items-center gap-2"><i data-lucide="sparkles" className="text-brand-600"></i> ë¦¬í¬íŠ¸ ìƒì„±</h2>
                        <div className="flex bg-slate-100 p-1 rounded-lg mb-6">
                            <button onClick={()=>setMode('weekly')} className={`flex-1 py-2 text-sm font-bold rounded ${mode==='weekly'?'bg-white shadow text-brand-600':'text-slate-500'}`}>ì£¼ê°„ íšŒì˜ë¡ (5P)</button>
                            <button onClick={()=>setMode('inspection')} className={`flex-1 py-2 text-sm font-bold rounded ${mode==='inspection'?'bg-white shadow text-brand-600':'text-slate-500'}`}>ë§¤ì¥ ì ê²€ (1P)</button>
                        </div>
                        <div className="bg-blue-50 p-4 rounded-lg text-sm text-blue-800 mb-auto">
                             <strong>ğŸ“š ì°¸ì¡° ë°ì´í„° (OKR Report):</strong><br/>
                             - 10ì›” ì „ì‚¬ ë§¤ì¶œ (2.7ì–µ)<br/>
                             - ëŒ€í•™ë¡œì  ì˜¤í”ˆ ì„±ê³¼ ë° ìš´ì˜ ì´ìŠˆ<br/>
                             - ì–‘ìƒì¶” ì›ê°€ ë° íŒŒíŠ¸ë„ˆì‹­ í˜„í™©
                        </div>
                        <button onClick={generate} disabled={loading} className="w-full bg-brand-600 text-white py-3 rounded-lg font-bold mt-4 disabled:opacity-50 flex justify-center items-center gap-2">
                            {loading ? <i data-lucide="loader-2" className="animate-spin"></i> : <i data-lucide="zap"></i>}
                            {loading ? "ìƒì„± ì¤‘..." : "ë¦¬í¬íŠ¸ ìƒì„±í•˜ê¸°"}
                        </button>
                    </div>
                    <div className="flex-1 bg-white p-8 rounded-xl border shadow-sm overflow-y-auto min-h-[500px] bg-[radial-gradient(#e2e8f0_1px,transparent_1px)] [background-size:16px_16px]">
                        {result ? <div className="prose prose-sm max-w-none whitespace-pre-line typing-cursor">{result}</div> : <div className="h-full flex flex-col items-center justify-center text-slate-400"><i data-lucide="file-text" className="w-12 h-12 mb-2 opacity-50"></i><p>ì„¤ì •ì„ ì„ íƒí•˜ê³  ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ì„¸ìš”.</p></div>}
                    </div>
                </div>
            );
        };

        // Placeholders for other menus
        const PlaceholderView = ({ title }) => (
            <div className="h-full flex flex-col items-center justify-center bg-white rounded-xl border border-dashed border-slate-300 p-10 text-slate-400 animate-fade-in">
                <i data-lucide="cone" className="w-16 h-16 mb-4 text-slate-300"></i>
                <h3 className="text-xl font-bold text-slate-600 mb-2">{title}</h3>
                <p>í•´ë‹¹ ë©”ë‰´ëŠ” ì‹¤ì œ ë°ì´í„° ì—°ë™ ì‹œ í™œì„±í™”ë©ë‹ˆë‹¤.</p>
            </div>
        );

        // [Main Layout]
        const App = () => {
            const [menu, setMenu] = useState('dashboard');
            const [store, setStore] = useState('all');
            const [credits, setCredits] = useState(100);
            const [isLoggedIn, setIsLoggedIn] = useState(false);

            useEffect(() => { if(window.lucide) window.lucide.createIcons(); }, [menu, isLoggedIn]);

            const handleLogin = (id, pw) => {
                if(id === 'demo' && pw === 'ctrlm2025!') setIsLoggedIn(true);
                else alert('ì•„ì´ë””/ë¹„ë²ˆì„ í™•ì¸í•˜ì„¸ìš” (demo / ctrlm2025!)');
            };

            if (!isLoggedIn) return (
                <div className="min-h-screen flex items-center justify-center bg-slate-100">
                    <div className="bg-white p-10 rounded-2xl shadow-xl w-96">
                        <h1 className="text-3xl font-bold text-navy-900 mb-8 text-center">HQ Login</h1>
                        <form onSubmit={(e)=>{e.preventDefault(); handleLogin(e.target.id.value, e.target.pw.value);}} className="space-y-4">
                            <input name="id" placeholder="ID (demo)" className="w-full p-3 border rounded" />
                            <input name="pw" type="password" placeholder="PW (ctrlm2025!)" className="w-full p-3 border rounded" />
                            <button className="w-full bg-navy-900 text-white py-3 rounded font-bold">ë¡œê·¸ì¸</button>
                        </form>
                    </div>
                </div>
            );

            const MENU_ITEMS = [
                { id: 'dashboard', name: 'HQ ì¢…í•© ëŒ€ì‹œë³´ë“œ', icon: 'bar-chart-2' },
                { id: 'sv', name: 'S.V. ìš´ì˜ ê´€ë¦¬', icon: 'clipboard-check' },
                { id: 'store', name: 'ì§€ì ë³„ ìƒì„¸', icon: 'store' },
                { id: 'menu', name: 'ë©”ë‰´/ì›ê°€ í˜„í™©', icon: 'utensils' },
                { id: 'marketing', name: 'ë§ˆì¼€íŒ… í˜„í™©', icon: 'megaphone' },
                { id: 'cctv', name: 'ìƒê¶Œ ë¶„ì„ (CCTV)', icon: 'camera' },
                { id: 'knowledge', name: 'ì§€ì‹/ì†Œí†µ', icon: 'book-open' },
                { id: 'alert', name: 'ì§€ì ë³„ ì•Œë¦¼', icon: 'bell' },
                { id: 'settings', name: 'ì„¤ì •', icon: 'settings' }
            ];

            return (
                <div className="flex min-h-screen">
                    <aside className="w-64 bg-navy-900 text-white fixed h-full flex flex-col z-10">
                        <div className="p-6 border-b border-navy-800 text-xl font-bold flex items-center gap-2">
                            <i data-lucide="layout-dashboard" className="text-brand-500"></i> RestoGenie
                        </div>
                        <nav className="flex-1 p-4 space-y-1 overflow-y-auto">
                            {MENU_ITEMS.map(item => (
                                <button key={item.id} onClick={()=>setMenu(item.id)} className={`w-full flex items-center gap-3 px-3 py-3 rounded-lg text-sm transition ${menu===item.id ? 'bg-brand-600 font-bold' : 'hover:bg-navy-800 text-slate-300'}`}>
                                    <i data-lucide={item.icon} className="w-4 h-4"></i> {item.name}
                                </button>
                            ))}
                            <div className="my-4 border-t border-navy-800"></div>
                            <button onClick={()=>setMenu('report')} className={`w-full flex items-center gap-3 px-3 py-3 rounded-lg text-sm ${menu==='report'?'bg-gradient-to-r from-brand-600 to-indigo-600 font-bold':'hover:bg-navy-800 text-slate-300'}`}>
                                <i data-lucide="sparkles" className="w-4 h-4"></i> AI ë¦¬í¬íŠ¸ ì„¼í„°
                            </button>
                        </nav>
                    </aside>
                    
                    <main className="ml-64 flex-1 p-8 relative bg-slate-50 min-h-screen">
                        <div className="flex justify-between items-center mb-8">
                            <h1 className="text-2xl font-bold text-navy-900">
                                {menu==='report' ? 'AI ìŠ¤ë§ˆíŠ¸ ë¦¬í¬íŠ¸ ì„¼í„°' : MENU_ITEMS.find(m=>m.id===menu)?.name}
                            </h1>
                            <div className="flex gap-4 items-center">
                                <select className="border p-2 rounded-lg bg-white font-bold shadow-sm" value={store} onChange={e=>setStore(e.target.value)}>
                                    {STORES.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}
                                </select>
                                <div className="bg-white border px-4 py-2 rounded-full shadow-sm flex items-center gap-2 cursor-pointer hover:bg-slate-50" onClick={()=>alert('ê´‘ê³ ë¥¼ ì‹œì²­í•˜ê³  ì½”ì¸ì„ ì¶©ì „í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')}>
                                    <div className="w-5 h-5 bg-yellow-400 rounded-full flex items-center justify-center text-xs text-white font-bold">P</div>
                                    <span className="font-bold">{credits}</span>
                                    <span className="text-xs text-slate-400">ì¶©ì „</span>
                                </div>
                            </div>
                        </div>
                        
                        <ErrorBoundary>
                            {menu === 'dashboard' && <DashboardView storeId={store} />}
                            {menu === 'report' && <AIReportView credits={credits} setCredits={setCredits} />}
                            {menu !== 'dashboard' && menu !== 'report' && <PlaceholderView title={MENU_ITEMS.find(m=>m.id===menu)?.name} />}
                            <AIChatbot />
                        </ErrorBoundary>
                    </main>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
